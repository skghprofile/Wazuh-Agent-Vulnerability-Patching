# Windows 10 PC Vulnerability Scan

Besides seeing vulnerabilities and security risks associated with a Linux machine, I wanted to see what vulnerabilities Wazuh found with my Windows 10 machine.

-From the scan, I saw the following:
    - 5 Critical Vulnerabilities.
    - 38 High Risk Vulnerabilities.
    - 17 Medium Risk Vulnerabilities.

![Wazuh Initial Vulnurability Scan](<../Images/Personal Windows PC/PCimg01.PNG>)

## Critical Vulnerabilities

To remediate these vulnerabilities, I started with the most critical ones first. For me, these were vulnerabilities associated with an outdated version of Python, and the vulnerability was published in 2022 from the CVE name.
    - I noticed that I didn't have the latest version of Python installed on my computer, so I downloaded and installed Python 3.12.2 before removing the older version. 
    - I also saw that the previous version I had installed on my PC was 3.11.x and not 3.10.x, as noted in the vulnerability report.
    - I uninstalled the 3.11.x version since I now had 3.12.2 installed and went to look for the original vulnerable version.
    - I remembered that another version of Python was installed on my computer but was located within another program. This program was Anaconda3 since I was using Python to create neural networks so I could learn how they worked.
    - In Anaconda3, the program and most of the packages I had installed were out-of-date. I also saw the Python 3.10.4 and 3.10.6 packages that were the cause of the vulnerability.
    - I updated the Python packages and ensured the old versions were removed.

Back in Wazuh, under the "Events" tab, I can see the changes I made fixed the vulnerabilities for Python 3
![Fixed Python Vulnurabilities](<../Images/Personal Windows PC/PCimg02.PNG>)

Next, I needed to fix the VLC media player application vulnerabilities.
This confused me since I regularly use and update the VLC media player application.
- I opened up the VLC media player application, clicked "Check For Updates" under the "Help" tab, and saw that it was up to date with version 3.0.20.
- I then went into my "Program Files" folder to check the version of the "vlc.exe" application in the "Properties" and once again saw version 3.0.20.
- The next step in my thought process was to see if it was installed elsewhere. I looked in the "Program Files (x86)" folder and found another "vlc.exe" there. Under the "Properties" tab, I saw that it was version 3.0.6 and then deleted the whole "VideoLAN" folder located in "Program Files (x86)".

![Old VLC in Program Files (x86)](<../Images/Personal Windows PC/PCimg03.PNG>)
![Current VLC in Program Files](<../Images/Personal Windows PC/PCimg04.PNG>)

## High and Medium Risk Vulnerabilities

Now that the critical risk vulnerabilities are fixed, I moved on to the high-risk vulnerabilities.
- These high-risk vulnerabilities include the following Programs:
  - Microsoft ASP.NET Core 3.1.10 Targeting Pack (x64)
  - Microsoft ASP.NET Core 3.1.3 Targeting Pack (x64)
  - Microsoft ASP.NET Core 3.1. Shared Framework (x64)
  - Microsoft ASP.NET Core 5.0.0 Targeting Pack (x64)
  - Microsoft ASP.NET Core 6.0.13 Shared Framework (x64)
  - Microsoft ASP.NET Core 6.0.18 Shared Framework (x64)
  - Microsoft ASP.NET Core 6.0.18 Targeting Pack (x64)
  - VLC Media Player 3.0.6 (This vulnerability was patched above)
![High Risk Vulnerabilities Page 1](<../Images/Personal Windows PC/PCimg05.PNG>)
![High Risk Vulnerabilities Page 2](<../Images/Personal Windows PC/PCimg06.PNG>)
![High Risk Vulnerabilities Page 3](<../Images/Personal Windows PC/PCimg07.PNG>)

As with Python above, I wanted to install the latest Microsoft .NET version before trying to remove the previous versions in case something critical relied on the .NET framework and to see if installing the latest .NET packages would remove previous versions and patch the vulnerabilities.

![Newest .NET 8.0.203 Installer](<../Images/Personal Windows PC/PCimg09.PNG>)

After installing the newest .NET SDK 8.0.203, I started removing previous versions.
- The first place I checked was "Add or Remove Programs" in "System Settings".
- From here, I can see a few previous versions that have been installed on my machine.
![Add or Remove previous .NET versions](<../Images/Personal Windows PC/PCimg08.PNG>)

After uninstalling those previous versions shown in the image above, I saw that none of the vulnerabilities associated with those .NET applications were fixed.
- I had to think about where else I had .NET applications installed.
- As I uninstalled previous versions, as shown in the image above, some versions were associated with Visual Studio. I had Visual Studio 2019 installed on my machine since I had projects to complete using it at my university.
- I opened up "Visual Studio Installer" and clicked "Modify" in the block that listed "Visual Studio 2019" so I could manage the packages that were installed. I did find .NET framework packages installed and went through the process of removing them.
- This unfortunately did not fix the vulnerabilities, and I knew that there were trace amounts left over on my PC that needed to be found and deleted.
- Before I investigated further, I uninstalled all of the packages I had with Visual Studio 2019, uninstalled Visual Studio 2019 itself, and installed a fresh updated version of Visual Studio 2022.
- This also didn't fix the remaining .NET vulnerabilities, but at least I could rule that out.

Now that the .NET vulnerabilities were deleted from the surface level through "Add or Remove Programs" and through "Visual Studio 2019", I needed to look deeper since Wazuh still shows traces of the files located somewhere on my machine.
My next thought was to look at the "Registry Editor" for leftover installation records so I could delete leftover traces found there.
- Under Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall I tried to find records related to the older .NET application versions through the "DisplayName" and "DisplayVersion" fields.
- I then went through and deleted all of the records in the \Uninstall folder.
![Registry Editor Example](<../Images/Personal Windows PC/PCimg11.PNG>)

This did not fix the issue, so my next step was to find other leftover files on my machine's C: drive.
Looking at one of the registry records, I could see through the "InstallSource" field that there may be leftover files in the "C:\ProgramData\PackageCache\" folder.
- I navigated there and deleted all the folders since they were just cache files.

This still did not solve the issue, so I opened up my C: in Windows Explorer and searched the whole drive for any folders and files related to "6.0." to find anything that may be left over.

![C: Search for foles and folders 6.0.](<../Images/Personal Windows PC/PCimg14.PNG>)

Once the search finished, I saw a couple of leftover folders and files for 6.0.13 and 6.0.18 were in "C:\Program Files\dotnet\". I went through the dotnet\ folder and all subfolders to delete all traces of .NET 3.1.5, 6.0.13, and 6.0.18.

![dotnet shared folder](<../Images/Personal Windows PC/PCimg13.PNG>)
![dotnet shared subfolder](<../Images/Personal Windows PC/PCimg12.PNG>)

After deleting those folders, I did another search, found a couple more files in a different directory, and deleted those.

![More Loose Files](<../Images/Personal Windows PC/PCimg16.PNG>)

Back on Wazuh's Vulnerability Event page, I saw the progress of deleting all the files and folders that were solving the vulnerabilities that Wazuh found initially.

![Updated Wazuh Events Page](<../Images/Personal Windows PC/PCimg15.PNG>)

Even after everything above, Wazuh still showed that there were files associated with the previous versions of .NET somewhere on my computer, but I could not find any other place where those loose files and folders might be. I waited several hours, but there was still no change, so I restarted both my personal machine and the Wazuh Server to see if that would fix the issue of the traces still being shown.

![Updated Vulnerability Scan](<../Images/Personal Windows PC/PCimg17.PNG>)

After restarting and waiting a few days, the remaining .NET vulnerabilities were solved. The last vulnerability that needs to be solved is updating the VMware Workstation, but I will do that at a later date.
![Final Vulnerability Scan](<../Images/Personal Windows PC/PCimg18.PNG>)

## Conclusion

Solving vulnerabilities through Wazuh was an interesting project for me. I keep the programs I use regularly up to date. Still, now I know to be more mindful when working through other programs with packages or extensions like Visual Studio and Anaconda3 to keep those up to date and ensure that the packages or extensions are entirely removed from the computer when performing an update or uninstall. I was also surprised that I had 2 instances of VLC Media Player on my machine, one in Program Files, which was up to date, and an older version in Program Files (86) that was out-of-date and had vulnerabilities.

I also now have a solid process that I'll use when updating programs, uninstalling previous versions of programs, and removing leftover files and folders. Here is my process simplified from the project above:
1. Update the application or program if possible
2. Remove the application or program through Windows Settings or Control Panel.
3. Search for the application or program in the Windows directory (Program Files, Program Files (86), ProgramData)
4. Remove leftover entries through Registry Editor.
5. Do a final search on the whole drive for any files or folders related to the program or application.
6. Restart the machine to remove anything cached or in a temp folder.
